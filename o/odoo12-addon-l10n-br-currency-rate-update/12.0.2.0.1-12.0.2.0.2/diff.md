# Comparing `tmp/odoo12_addon_l10n_br_currency_rate_update-12.0.2.0.1-py3-none-any.whl.zip` & `tmp/odoo12_addon_l10n_br_currency_rate_update-12.0.2.0.2-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,21 +1,21 @@
-Zip file size: 38488 bytes, number of entries: 19
--rw-r--r--  2.0 unx     3804 b- defN 22-Oct-26 20:10 odoo/addons/l10n_br_currency_rate_update/README.rst
--rw-r--r--  2.0 unx       87 b- defN 22-Oct-26 20:10 odoo/addons/l10n_br_currency_rate_update/__init__.py
--rw-r--r--  2.0 unx      576 b- defN 22-Oct-26 20:10 odoo/addons/l10n_br_currency_rate_update/__manifest__.py
--rw-r--r--  2.0 unx     1241 b- defN 22-Oct-26 20:10 odoo/addons/l10n_br_currency_rate_update/i18n/l10n_br_currency_rate_update.pot
--rw-r--r--  2.0 unx     1584 b- defN 22-Oct-26 20:10 odoo/addons/l10n_br_currency_rate_update/i18n/pt_BR.po
--rw-r--r--  2.0 unx      111 b- defN 22-Oct-26 20:10 odoo/addons/l10n_br_currency_rate_update/models/__init__.py
--rw-r--r--  2.0 unx     3114 b- defN 22-Oct-26 20:10 odoo/addons/l10n_br_currency_rate_update/models/res_currency_rate_provider_bcb.py
--rw-r--r--  2.0 unx      439 b- defN 22-Oct-26 20:10 odoo/addons/l10n_br_currency_rate_update/readme/CONFIGURE.rst
--rw-r--r--  2.0 unx       44 b- defN 22-Oct-26 20:10 odoo/addons/l10n_br_currency_rate_update/readme/CONTRIBUTORS.rst
--rw-r--r--  2.0 unx      471 b- defN 22-Oct-26 20:10 odoo/addons/l10n_br_currency_rate_update/readme/DESCRIPTION.rst
--rw-r--r--  2.0 unx      215 b- defN 22-Oct-26 20:10 odoo/addons/l10n_br_currency_rate_update/readme/USAGE.rst
--rw-r--r--  2.0 unx    21278 b- defN 22-Oct-26 20:10 odoo/addons/l10n_br_currency_rate_update/static/description/icon.png
--rw-r--r--  2.0 unx    13527 b- defN 22-Oct-26 20:10 odoo/addons/l10n_br_currency_rate_update/static/description/index.html
--rw-r--r--  2.0 unx      110 b- defN 22-Oct-26 20:10 odoo/addons/l10n_br_currency_rate_update/tests/__init__.py
--rw-r--r--  2.0 unx     3555 b- defN 22-Oct-26 20:10 odoo/addons/l10n_br_currency_rate_update/tests/test_currency_rate_update_bcb.py
--rw-r--r--  2.0 unx     4470 b- defN 22-Oct-26 20:10 odoo12_addon_l10n_br_currency_rate_update-12.0.2.0.1.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 22-Oct-26 20:10 odoo12_addon_l10n_br_currency_rate_update-12.0.2.0.1.dist-info/WHEEL
--rw-r--r--  2.0 unx        5 b- defN 22-Oct-26 20:10 odoo12_addon_l10n_br_currency_rate_update-12.0.2.0.1.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     2251 b- defN 22-Oct-26 20:10 odoo12_addon_l10n_br_currency_rate_update-12.0.2.0.1.dist-info/RECORD
-19 files, 56974 bytes uncompressed, 34552 bytes compressed:  39.4%
+Zip file size: 39294 bytes, number of entries: 19
+-rw-r--r--  2.0 unx     3804 b- defN 23-Jun-10 15:04 odoo/addons/l10n_br_currency_rate_update/README.rst
+-rw-r--r--  2.0 unx       87 b- defN 23-Jun-10 15:04 odoo/addons/l10n_br_currency_rate_update/__init__.py
+-rw-r--r--  2.0 unx      576 b- defN 23-Jun-10 15:04 odoo/addons/l10n_br_currency_rate_update/__manifest__.py
+-rw-r--r--  2.0 unx     1241 b- defN 23-Jun-10 15:04 odoo/addons/l10n_br_currency_rate_update/i18n/l10n_br_currency_rate_update.pot
+-rw-r--r--  2.0 unx     1584 b- defN 23-Jun-10 15:04 odoo/addons/l10n_br_currency_rate_update/i18n/pt_BR.po
+-rw-r--r--  2.0 unx      111 b- defN 23-Jun-10 15:04 odoo/addons/l10n_br_currency_rate_update/models/__init__.py
+-rw-r--r--  2.0 unx     3114 b- defN 23-Jun-10 15:04 odoo/addons/l10n_br_currency_rate_update/models/res_currency_rate_provider_bcb.py
+-rw-r--r--  2.0 unx      439 b- defN 23-Jun-10 15:04 odoo/addons/l10n_br_currency_rate_update/readme/CONFIGURE.rst
+-rw-r--r--  2.0 unx       44 b- defN 23-Jun-10 15:04 odoo/addons/l10n_br_currency_rate_update/readme/CONTRIBUTORS.rst
+-rw-r--r--  2.0 unx      471 b- defN 23-Jun-10 15:04 odoo/addons/l10n_br_currency_rate_update/readme/DESCRIPTION.rst
+-rw-r--r--  2.0 unx      215 b- defN 23-Jun-10 15:04 odoo/addons/l10n_br_currency_rate_update/readme/USAGE.rst
+-rw-r--r--  2.0 unx    21278 b- defN 23-Jun-10 15:04 odoo/addons/l10n_br_currency_rate_update/static/description/icon.png
+-rw-r--r--  2.0 unx    13527 b- defN 23-Jun-10 15:04 odoo/addons/l10n_br_currency_rate_update/static/description/index.html
+-rw-r--r--  2.0 unx      110 b- defN 23-Jun-10 15:04 odoo/addons/l10n_br_currency_rate_update/tests/__init__.py
+-rw-r--r--  2.0 unx     6770 b- defN 23-Jun-10 15:04 odoo/addons/l10n_br_currency_rate_update/tests/test_currency_rate_update_bcb.py
+-rw-r--r--  2.0 unx     4470 b- defN 23-Jun-10 15:04 odoo12_addon_l10n_br_currency_rate_update-12.0.2.0.2.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Jun-10 15:04 odoo12_addon_l10n_br_currency_rate_update-12.0.2.0.2.dist-info/WHEEL
+-rw-r--r--  2.0 unx        5 b- defN 23-Jun-10 15:04 odoo12_addon_l10n_br_currency_rate_update-12.0.2.0.2.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     2251 b- defN 23-Jun-10 15:04 odoo12_addon_l10n_br_currency_rate_update-12.0.2.0.2.dist-info/RECORD
+19 files, 60189 bytes uncompressed, 35358 bytes compressed:  41.3%
```

## zipnote {}

```diff
@@ -39,20 +39,20 @@
 
 Filename: odoo/addons/l10n_br_currency_rate_update/tests/__init__.py
 Comment: 
 
 Filename: odoo/addons/l10n_br_currency_rate_update/tests/test_currency_rate_update_bcb.py
 Comment: 
 
-Filename: odoo12_addon_l10n_br_currency_rate_update-12.0.2.0.1.dist-info/METADATA
+Filename: odoo12_addon_l10n_br_currency_rate_update-12.0.2.0.2.dist-info/METADATA
 Comment: 
 
-Filename: odoo12_addon_l10n_br_currency_rate_update-12.0.2.0.1.dist-info/WHEEL
+Filename: odoo12_addon_l10n_br_currency_rate_update-12.0.2.0.2.dist-info/WHEEL
 Comment: 
 
-Filename: odoo12_addon_l10n_br_currency_rate_update-12.0.2.0.1.dist-info/top_level.txt
+Filename: odoo12_addon_l10n_br_currency_rate_update-12.0.2.0.2.dist-info/top_level.txt
 Comment: 
 
-Filename: odoo12_addon_l10n_br_currency_rate_update-12.0.2.0.1.dist-info/RECORD
+Filename: odoo12_addon_l10n_br_currency_rate_update-12.0.2.0.2.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## odoo/addons/l10n_br_currency_rate_update/__manifest__.py

```diff
@@ -1,14 +1,14 @@
 # Copyright (C) 2019 Renato Lima - Akretion <renato.lima@akretion.com.br>
 # License AGPL-3.0 or later (https://www.gnu.org/licenses/agpl).
 
 {
     "name": "Currency Rate Update BR",
     "summary": "Update exchange rates using OCA modules for Brazil",
-    "version": "12.0.2.0.1",
+    "version": "12.0.2.0.2",
     "author": "Akretion, " "Odoo Community Association (OCA)",
     "website": "https://github.com/OCA/l10n-brazil",
     "license": "AGPL-3",
     "category": "Financial Management/Configuration",
     "depends": ["currency_rate_update"],
     "development_status": "Beta",
     "installable": True,
```

## odoo/addons/l10n_br_currency_rate_update/tests/test_currency_rate_update_bcb.py

```diff
@@ -1,15 +1,98 @@
 # Copyright 2019 Akretion - Renato Lima <renato.lima@akretion.com.br>
 # License AGPL-3.0 or later (https://www.gnu.org/licenses/agpl).
 
+import logging
+from datetime import datetime
+from os import environ
+from unittest import mock
+
 from dateutil.relativedelta import relativedelta
+from decorator import decorate
 
 from odoo import fields
 from odoo.tests import SavepointCase
 
+_logger = logging.getLogger(__name__)
+
+
+def _not_every_day_test(method, self, modulo=7, remaining=1):
+    if datetime.now().day % modulo == remaining or environ.get("CI_FORCE_IBPT"):
+        return method(self)
+    else:
+        return lambda: _logger.info(
+            "Skipping test today because datetime.now().day %% %s != %s"
+            % (modulo, remaining)
+        )
+
+
+def not_every_day_test(method):
+    """
+    Decorate test methods to query the Banco Do Brasil only
+    1 day out of 7 and skip tests otherwise.
+    Indeed the IBPT webservice often returns errors and it sucks
+    to crash the entire l10n-brazil test suite because of this.
+    the CI_FORCE_IBPT env var can be set to force the test anyhow.
+    """
+    return decorate(method, _not_every_day_test)
+
+
+def mocked_requests_get(*args, **kwargs):
+    class MockResponse:
+        def __init__(self, json_data, status_code):
+            self.json_data = json_data
+            self.status_code = status_code
+
+        def ok(self):
+            return True
+
+        def json(self):
+            return self.json_data
+
+    # the same as rates during 2 days:
+    return MockResponse(
+        {
+            "value": [
+                {
+                    "paridadeCompra": 1.0,
+                    "paridadeVenda": 1.0,
+                    "cotacaoCompra": 4.9786,
+                    "cotacaoVenda": 4.9792,
+                    "dataHoraCotacao": "2023-05-29 10:10:20.119",
+                    "tipoBoletim": "Abertura",
+                },
+                {
+                    "paridadeCompra": 1.0,
+                    "paridadeVenda": 1.0,
+                    "cotacaoCompra": 4.9948,
+                    "cotacaoVenda": 4.9954,
+                    "dataHoraCotacao": "2023-05-29 13:10:18.54",
+                    "tipoBoletim": "Fechamento",
+                },
+                {
+                    "paridadeCompra": 1.0,
+                    "paridadeVenda": 1.0,
+                    "cotacaoCompra": 5.0497,
+                    "cotacaoVenda": 5.0503,
+                    "dataHoraCotacao": "2023-05-30 10:09:35.311",
+                    "tipoBoletim": "Abertura",
+                },
+                {
+                    "paridadeCompra": 1.0,
+                    "paridadeVenda": 1.0,
+                    "cotacaoCompra": 5.0587,
+                    "cotacaoVenda": 5.0593,
+                    "dataHoraCotacao": "2023-05-30 13:11:51.392",
+                    "tipoBoletim": "Fechamento",
+                },
+            ]
+        },
+        200,
+    )
+
 
 class TestCurrencyRateUpdateBCB(SavepointCase):
     @classmethod
     def setUpClass(cls):
         super().setUpClass()
         cls.Company = cls.env["res.company"]
         cls.CurrencyRate = cls.env["res.currency.rate"]
@@ -30,56 +113,71 @@
             {
                 "service": "BCB",
                 "currency_ids": [(4, cls.usd_currency.id), (4, cls.eur_currency.id)],
             }
         )
         cls.CurrencyRate.search([]).unlink()
 
+    @mock.patch("requests.get", side_effect=mocked_requests_get)
+    def test_mock(self, mock_get):
+        self.bcb_provider._update(self.today - relativedelta(days=2), self.today)
+        rates = self.CurrencyRate.search(
+            [("currency_id", "=", self.usd_currency.id)], limit=1
+        )
+        self.assertTrue(rates)
+        self.CurrencyRate.search([("currency_id", "=", self.usd_currency.id)]).unlink()
+
+    @not_every_day_test
     def test_get_supported_currencies(self):
         currencies = self.bcb_provider._get_supported_currencies()
         self.assertTrue(currencies)
 
+    @not_every_day_test
     def test_update_BCB_today(self):
         """No checks are made since today may not be a banking day"""
         self.bcb_provider._update(self.today, self.today)
         self.CurrencyRate.search([("currency_id", "=", self.usd_currency.id)]).unlink()
 
+    @not_every_day_test
     def test_update_BCB_month(self):
         self.bcb_provider._update(self.today - relativedelta(months=1), self.today)
 
         rates = self.CurrencyRate.search(
             [("currency_id", "=", self.usd_currency.id)], limit=1
         )
         self.assertTrue(rates)
 
         self.CurrencyRate.search([("currency_id", "=", self.usd_currency.id)]).unlink()
 
+    @not_every_day_test
     def test_update_BCB_year(self):
         self.bcb_provider._update(self.today - relativedelta(years=1), self.today)
 
         rates = self.CurrencyRate.search(
             [("currency_id", "=", self.usd_currency.id)], limit=1
         )
         self.assertTrue(rates)
 
         self.CurrencyRate.search([("currency_id", "=", self.usd_currency.id)]).unlink()
 
+    @not_every_day_test
     def test_update_BCB_scheduled(self):
         self.bcb_provider.interval_type = "days"
         self.bcb_provider.interval_number = 14
         self.bcb_provider.next_run = self.today - relativedelta(days=1)
         self.bcb_provider._scheduled_update()
 
         rates = self.CurrencyRate.search(
             [("currency_id", "=", self.usd_currency.id)], limit=1
         )
         self.assertTrue(rates)
 
         self.CurrencyRate.search([("currency_id", "=", self.usd_currency.id)]).unlink()
 
+    @not_every_day_test
     def test_update_BCB_no_base_update(self):
         self.bcb_provider.interval_type = "days"
         self.bcb_provider.interval_number = 14
         self.bcb_provider.next_run = self.today - relativedelta(days=1)
         self.bcb_provider._scheduled_update()
 
         rates = self.CurrencyRate.search(
```

## Comparing `odoo12_addon_l10n_br_currency_rate_update-12.0.2.0.1.dist-info/METADATA` & `odoo12_addon_l10n_br_currency_rate_update-12.0.2.0.2.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: odoo12-addon-l10n-br-currency-rate-update
-Version: 12.0.2.0.1
+Version: 12.0.2.0.2
 Summary: Update exchange rates using OCA modules for Brazil
 Home-page: https://github.com/OCA/l10n-brazil
 Author: Akretion, Odoo Community Association (OCA)
 Author-email: support@odoo-community.org
 License: AGPL-3
 Platform: UNKNOWN
 Classifier: Programming Language :: Python
```

## Comparing `odoo12_addon_l10n_br_currency_rate_update-12.0.2.0.1.dist-info/RECORD` & `odoo12_addon_l10n_br_currency_rate_update-12.0.2.0.2.dist-info/RECORD`

 * *Files 15% similar despite different names*

```diff
@@ -1,19 +1,19 @@
 odoo/addons/l10n_br_currency_rate_update/README.rst,sha256=XtD8oobBr2ge5bAJiGeZwWjGUd87zjMqgMvlCO9sLLk,3804
 odoo/addons/l10n_br_currency_rate_update/__init__.py,sha256=nGN_WM7n8r6bQC4oJhP4N2IAYaislr5pRn8rlpVM3po,87
-odoo/addons/l10n_br_currency_rate_update/__manifest__.py,sha256=4x8Ygb-EgglAdJRVG75nhKuf8ctSO0Htpc9oHFI_TVk,576
+odoo/addons/l10n_br_currency_rate_update/__manifest__.py,sha256=M5FzMVkT5dBwN00BxPzgI3UVaeIIjD_nUvf0wQ_pdd8,576
 odoo/addons/l10n_br_currency_rate_update/i18n/l10n_br_currency_rate_update.pot,sha256=XR_iA1Rb5zWs9FypQjk37lW67rQvE-gmh3OWZTr1yIc,1241
 odoo/addons/l10n_br_currency_rate_update/i18n/pt_BR.po,sha256=jDPapLYmxD26RKou3a27CSFocMM7Z2qcyq_juWNGH60,1584
 odoo/addons/l10n_br_currency_rate_update/models/__init__.py,sha256=iRY2caJB49dZw54B3nCidlm6trspOR0Yzbq7rwFjT8A,111
 odoo/addons/l10n_br_currency_rate_update/models/res_currency_rate_provider_bcb.py,sha256=RIISa47__anDnV2JiL4O-YukzPpdO8VAzvPOUJTcyLM,3114
 odoo/addons/l10n_br_currency_rate_update/readme/CONFIGURE.rst,sha256=n49uVPw6HQK2COmzNOj55C7PsaA8lM28Yr37TyqZlsE,439
 odoo/addons/l10n_br_currency_rate_update/readme/CONTRIBUTORS.rst,sha256=ZIGRyN104hAlxfWUGjVVqjKGRx0qciMS-pvbotAmP50,44
 odoo/addons/l10n_br_currency_rate_update/readme/DESCRIPTION.rst,sha256=U29eDpflfo5_J3mSV35VJwYB_ZwPj94Lueq4gL1IRjI,471
 odoo/addons/l10n_br_currency_rate_update/readme/USAGE.rst,sha256=AlQj_lG7ZdEzcxdZRGC_xMuI3igjxblNDuhQqhM7ASc,215
 odoo/addons/l10n_br_currency_rate_update/static/description/icon.png,sha256=w5S8noy_7eOSsdg17-8RDghcf0Pq31x9snothwyJgeA,21278
 odoo/addons/l10n_br_currency_rate_update/static/description/index.html,sha256=e9RHOS7C0OdiuJb8UxO8zZZ5kJ-rKF201zcAATeKoaE,13527
 odoo/addons/l10n_br_currency_rate_update/tests/__init__.py,sha256=_3sPNWES3G6O8QeqosUm8FgBc7FOBG5U67aNbPK2Ock,110
-odoo/addons/l10n_br_currency_rate_update/tests/test_currency_rate_update_bcb.py,sha256=Q_kHeoa0t_whyjfj6ktxKo2cax-OmK1sXbu4hC2rAco,3555
-odoo12_addon_l10n_br_currency_rate_update-12.0.2.0.1.dist-info/METADATA,sha256=KhLUa1r1EP01Qz7O_W5cPNbqEqnRKeo8Qi_8ig40JVs,4470
-odoo12_addon_l10n_br_currency_rate_update-12.0.2.0.1.dist-info/WHEEL,sha256=G16H4A3IeoQmnOrYV4ueZGKSjhipXx8zc8nu9FGlvMA,92
-odoo12_addon_l10n_br_currency_rate_update-12.0.2.0.1.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
-odoo12_addon_l10n_br_currency_rate_update-12.0.2.0.1.dist-info/RECORD,,
+odoo/addons/l10n_br_currency_rate_update/tests/test_currency_rate_update_bcb.py,sha256=DA5YUHDUe-I2j1u0vB5KkA2j8tUR5KwerFcgHtGloTI,6770
+odoo12_addon_l10n_br_currency_rate_update-12.0.2.0.2.dist-info/METADATA,sha256=qLsdtiCRLntuzpMtRO6ry0_x6iEMhdTyUXopMQ6xedo,4470
+odoo12_addon_l10n_br_currency_rate_update-12.0.2.0.2.dist-info/WHEEL,sha256=2wepM1nk4DS4eFpYrW1TTqPcoGNfHhhO_i5m4cOimbo,92
+odoo12_addon_l10n_br_currency_rate_update-12.0.2.0.2.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
+odoo12_addon_l10n_br_currency_rate_update-12.0.2.0.2.dist-info/RECORD,,
```

